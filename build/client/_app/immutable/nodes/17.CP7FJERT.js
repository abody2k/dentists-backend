import{s as j,e as p,b as F,c as g,f as T,g as w,h as H,d as b,j as q,i as I,k as _,l as z,n as C,m as J,o as P,t as L,p as M,q as O}from"../chunks/scheduler.C7Xo_3aa.js";import{e as A}from"../chunks/each.DGNUWULW.js";import{S as R,i as U}from"../chunks/index.NYh16Rov.js";import{u as x,w as Y}from"../chunks/xlsx.CqXLKV2Q.js";import{f as G}from"../chunks/not.u4UXoo5E.js";function X(c,a,o){const l=c.slice();return l[5]=a[o],l}function B(c){let a,o,l=c[1].find(f).n+"",m,s,u,h=c[5].g+"",t;function f(...n){return c[4](c[5],...n)}return{c(){a=p("tr"),o=p("td"),m=L(l),s=F(),u=p("td"),t=L(h)},l(n){a=g(n,"TR",{});var d=T(a);o=g(d,"TD",{});var k=T(o);m=M(k,l),k.forEach(b),s=H(d),u=g(d,"TD",{});var v=T(u);t=M(v,h),v.forEach(b),d.forEach(b)},m(n,d){I(n,a,d),_(a,o),_(o,m),_(a,s),_(a,u),_(u,t)},p(n,d){c=n,d&3&&l!==(l=c[1].find(f).n+"")&&O(m,l),d&1&&h!==(h=c[5].g+"")&&O(t,h)},d(n){n&&b(a)}}}function K(c){let a,o,l,m="<tr><th>Name</th><th>Mark</th></tr>",s,u,h,t,f,n="Export XLSX",d,k,v=A(c[0]),i=[];for(let r=0;r<v.length;r+=1)i[r]=B(X(c,v,r));return{c(){a=p("main"),o=p("table"),l=p("thead"),l.innerHTML=m,s=p("tbody");for(let r=0;r<i.length;r+=1)i[r].c();u=F(),h=p("tfoot"),t=p("td"),f=p("button"),f.textContent=n,this.h()},l(r){a=g(r,"MAIN",{});var E=T(a);o=g(E,"TABLE",{});var e=T(o);l=g(e,"THEAD",{"data-svelte-h":!0}),w(l)!=="svelte-12zzm8p"&&(l.innerHTML=m),s=g(e,"TBODY",{});var D=T(s);for(let S=0;S<i.length;S+=1)i[S].l(D);u=H(D),D.forEach(b),h=g(e,"TFOOT",{});var y=T(h);t=g(y,"TD",{colspan:!0});var N=T(t);f=g(N,"BUTTON",{"data-svelte-h":!0}),w(f)!=="svelte-g3l2ov"&&(f.textContent=n),N.forEach(b),y.forEach(b),e.forEach(b),E.forEach(b),this.h()},h(){q(t,"colspan",2)},m(r,E){I(r,a,E),_(a,o),_(o,l),_(o,s);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(s,null);_(s,u),_(o,h),_(h,t),_(t,f),d||(k=z(f,"click",c[2]),d=!0)},p(r,[E]){if(E&3){v=A(r[0]);let e;for(e=0;e<v.length;e+=1){const D=X(r,v,e);i[e]?i[e].p(D,E):(i[e]=B(D),i[e].c(),i[e].m(s,u))}for(;e<i.length;e+=1)i[e].d(1);i.length=v.length}},i:C,o:C,d(r){r&&b(a),J(i,r),d=!1,k()}}}function Q(c,a,o){let l=[],m=[],{data:s}=a;P(async()=>{console.log(),G("a/gsrs",{examID:Number(s.d.split("-")[2]),ID:Number(s.d.split("-")[1]),t:Number(s.d.split("-")[3]),ac:Number(s.d.split("-")[0])}).then(t=>{console.log(t),o(0,l=t.r),o(1,m=t.n)})});function u(){const t=x.json_to_sheet(l.map(n=>(n.name=m.find(d=>d.i==n.i).n,delete n.i,n.grade=n.g,delete n.g,n))),f=x.book_new();x.book_append_sheet(f,t,"Data"),Y(f,"SheetJSSvelteAoO.xlsx")}const h=(t,f)=>f.i==t.i;return c.$$set=t=>{"data"in t&&o(3,s=t.data)},[l,m,u,s,h]}class et extends R{constructor(a){super(),U(this,a,Q,K,j,{data:3})}}export{et as component};
